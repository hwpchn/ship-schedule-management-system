# ğŸš¢ èˆ¹èˆ¶èˆªçº¿ç®¡ç†ç³»ç»Ÿ - å¼€å‘å·¥å…·

.PHONY: help install test lint format clean migrate runserver

# é»˜è®¤ç›®æ ‡
help:
	@echo "ğŸš¢ èˆ¹èˆ¶èˆªçº¿ç®¡ç†ç³»ç»Ÿ - å¯ç”¨å‘½ä»¤:"
	@echo ""
	@echo "ğŸ“¦ ç¯å¢ƒç®¡ç†:"
	@echo "  install     - å®‰è£…ä¾èµ–åŒ…"
	@echo "  install-dev - å®‰è£…å¼€å‘ä¾èµ–"
	@echo ""
	@echo "ğŸ§ª æµ‹è¯•ç›¸å…³:"
	@echo "  test        - è¿è¡Œæ‰€æœ‰æµ‹è¯•"
	@echo "  test-models - è¿è¡Œæ¨¡å‹æµ‹è¯•"
	@echo "  test-auth   - è¿è¡Œè®¤è¯æµ‹è¯•"
	@echo "  test-api    - è¿è¡ŒAPIæµ‹è¯•"
	@echo "  coverage    - ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š"
	@echo ""
	@echo "ğŸ”§ ä»£ç è´¨é‡:"
	@echo "  lint        - ä»£ç è´¨é‡æ£€æŸ¥"
	@echo "  format      - ä»£ç æ ¼å¼åŒ–"
	@echo "  check       - è¿è¡Œæ‰€æœ‰æ£€æŸ¥"
	@echo ""
	@echo "ğŸ—„ï¸ æ•°æ®åº“:"
	@echo "  migrate     - æ‰§è¡Œæ•°æ®åº“è¿ç§»"
	@echo "  makemigrations - åˆ›å»ºè¿ç§»æ–‡ä»¶"
	@echo ""
	@echo "ğŸš€ æœåŠ¡å™¨:"
	@echo "  runserver   - å¯åŠ¨å¼€å‘æœåŠ¡å™¨"
	@echo "  shell       - å¯åŠ¨Django shell"
	@echo ""
	@echo "ğŸ§¹ æ¸…ç†:"
	@echo "  clean       - æ¸…ç†ç¼“å­˜æ–‡ä»¶"

# ç¯å¢ƒç®¡ç†
install:
	pip install -r requirements.txt

install-dev:
	pip install -r requirements-dev.txt

# æµ‹è¯•
test:
	python manage.py test --settings=ship_schedule.test_settings

test-models:
	python run_tests.py models

test-auth:
	python run_tests.py auth

test-api:
	python run_tests.py api

coverage:
	python run_tests.py coverage

# ä»£ç è´¨é‡
lint:
	flake8 .
	mypy .

format:
	black .
	isort .

check: lint test
	@echo "âœ… æ‰€æœ‰æ£€æŸ¥é€šè¿‡"

# æ•°æ®åº“
migrate:
	python manage.py migrate

makemigrations:
	python manage.py makemigrations

# æœåŠ¡å™¨
runserver:
	python manage.py runserver

shell:
	python manage.py shell

# æ¸…ç†
clean:
	find . -type f -name "*.pyc" -delete
	find . -type d -name "__pycache__" -delete
	find . -type d -name "*.egg-info" -exec rm -rf {} +
	rm -rf .pytest_cache/
	rm -rf htmlcov/
	rm -rf .coverage
